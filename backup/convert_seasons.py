import aiosqlite
import asyncio

seasons =  [["1946-47", "NULL", "NULL", "1946-11-01", "1947-03-20", "NULL", "NULL", "1947-03-22", "1947-04-10", "NULL"], ["1947-48", "NULL", "NULL", "1947-11-01", "1948-03-20", "NULL", "NULL", "1948-03-21", "1948-04-10", "NULL"], ["1948-49", "NULL", "NULL", "1948-11-06", "1949-03-20", "NULL", "NULL", "1949-03-22", "1949-04-23", "NULL"], ["1949-50", "NULL", "NULL", "1949-10-29", "1950-03-19", "NULL", "NULL", "1950-03-22", "1950-04-23", "NULL"], ["1950-51", "NULL", "NULL", "1950-10-31", "1951-03-18", "NULL", "NULL", "1951-03-20", "1951-04-21", "NULL"], ["1951-52", "NULL", "NULL", "1951-10-30", "1952-03-20", "NULL", "NULL", "1952-03-22", "1952-04-12", "NULL"], ["1952-53", "NULL", "NULL", "1952-10-31", "1953-03-21", "NULL", "NULL", "1953-03-24", "1953-04-11", "NULL"], ["1953-54", "NULL", "NULL", "1953-10-30", "1954-03-13", "NULL", "NULL", "1954-03-16", "1954-04-09", "NULL"], ["1954-55", "NULL", "NULL", "1954-10-29", "1955-03-12", "NULL", "NULL", "1955-03-15", "1955-04-09", "NULL"], ["1955-56", "NULL", "NULL", "1955-10-27", "1956-03-17", "NULL", "NULL", "1956-03-18", "1956-04-07", "NULL"], ["1956-57", "NULL", "NULL", "1956-10-30", "1957-03-16", "NULL", "NULL", "1957-03-19", "1957-04-13", "NULL"], ["1957-58", "NULL", "NULL", "1957-10-22", "1958-03-15", "NULL", "NULL", "1958-03-17", "1958-04-12", "NULL"], ["1958-59", "NULL", "NULL", "1958-10-24", "1959-03-14", "NULL", "NULL", "1959-03-17", "1959-04-09", "NULL"], ["1959-60", "NULL", "NULL", "1959-10-23", "1960-03-19", "NULL", "NULL", "1960-03-22", "1960-04-09", "NULL"], ["1960-61", "NULL", "NULL", "1960-10-19", "1961-03-19", "NULL", "NULL", "1961-03-21", "1961-04-09", "NULL"], ["1961-62", "NULL", "NULL", "1961-10-17", "1962-03-20", "NULL", "NULL", "1962-03-23", "1962-04-12", "NULL"], ["1962-63", "NULL", "NULL", "1962-10-16", "1963-03-14", "NULL", "NULL", "1963-03-16", "1963-04-11", "NULL"], ["1963-64", "NULL", "NULL", "1963-10-15", "1964-03-19", "NULL", "NULL", "1964-03-20", "1964-04-12", "NULL"], ["1964-65", "NULL", "NULL", "1964-10-16", "1965-03-18", "NULL", "NULL", "1965-03-19", "1965-04-25", "NULL"], ["1965-66", "NULL", "NULL", "1965-10-15", "1966-03-23", "NULL", "NULL", "1966-03-26", "1966-05-01", "NULL"], ["1966-67", "NULL", "NULL", "1966-10-14", "1967-03-22", "NULL", "NULL", "1967-03-25", "1967-04-30", "NULL"], ["1967-68", "NULL", "NULL", "1967-10-13", "1968-03-28", "NULL", "NULL", "1968-03-30", "1968-04-21", "NULL"], ["1968-69", "NULL", "NULL", "1968-10-17", "1969-03-23", "NULL", "NULL", "1969-03-26", "1969-04-24", "NULL"], ["1969-70", "NULL", "NULL", "1969-10-16", "1970-03-25", "NULL", "NULL", "1970-03-27", "1970-04-26", "NULL"], ["1970-71", "NULL", "NULL", "1970-10-15", "1971-03-23", "NULL", "NULL", "1971-03-26", "1971-05-02", "NULL"], ["1971-72", "NULL", "NULL", "1971-10-12", "1972-04-01", "NULL", "NULL", "1972-04-05", "1972-05-10", "NULL"], ["1972-73", "NULL", "NULL", "1972-10-10", "1973-04-05", "NULL", "NULL", "1973-04-07", "1973-05-10", "NULL"], ["1973-74", "NULL", "NULL", "1973-10-10", "1974-04-03", "NULL", "NULL", "1974-04-06", "1974-05-12", "NULL"], ["1974-75", "NULL", "NULL", "1974-10-09", "1975-04-06", "NULL", "NULL", "1975-04-09", "1975-05-18", "NULL"], ["1975-76", "NULL", "NULL", "1975-10-10", "1976-04-11", "NULL", "NULL", "1976-04-14", "1976-06-06", "NULL"], ["1976-77", "NULL", "NULL", "1976-10-08", "1977-04-10", "NULL", "NULL", "1977-04-13", "1977-05-29", "NULL"], ["1977-78", "NULL", "NULL", "1977-10-07", "1978-04-09", "NULL", "NULL", "1978-04-12", "1978-05-28", "NULL"], ["1978-79", "NULL", "NULL", "1978-10-13", "1979-04-08", "NULL", "NULL", "1979-04-11", "1979-05-27", "NULL"], ["1979-80", "NULL", "NULL", "1979-10-12", "1980-04-06", "NULL", "NULL", "1980-04-09", "1980-05-16", "NULL"], ["1980-81", "1980-09-26", "1980-10-11", "1980-10-10", "1981-04-12", "NULL", "NULL", "1981-04-15", "1981-05-31", "NULL"], ["1981-82", "1981-09-25", "1981-10-10", "1981-10-09", "1982-04-18", "NULL", "NULL", "1982-04-20", "1982-06-08", "NULL"], ["1982-83", "1982-09-24", "1982-10-09", "1982-10-29", "1983-04-17", "NULL", "NULL", "1983-04-19", "1983-06-12", "NULL"], ["1983-84", "1983-09-30", "1983-10-14", "1983-10-28", "1984-04-15", "NULL", "NULL", "1984-04-17", "1984-06-12", "NULL"], ["1984-85", "1984-10-05", "1984-10-19", "1984-10-26", "1985-04-14", "NULL", "NULL", "1985-04-18", "1985-06-09", "NULL"], ["1985-86", "1985-10-04", "1985-10-25", "1985-10-25", "1986-04-13", "NULL", "NULL", "1986-04-17", "1986-06-08", "NULL"], ["1986-87", "1986-10-03", "1986-10-24", "1986-10-31", "1987-04-12", "NULL", "NULL", "1987-04-16", "1987-06-14", "NULL"], ["1987-88", "1987-10-02", "1987-10-23", "1987-10-31", "1988-04-17", "NULL", "NULL", "1988-04-21", "1988-06-13", "NULL"], ["1988-89", "1988-10-03", "1988-10-21", "1988-11-04", "1989-04-16", "NULL", "NULL", "1989-04-20", "1989-06-13", "NULL"], ["1989-90", "1989-10-06", "1989-10-27", "1989-11-03", "1990-04-22", "NULL", "NULL", "1990-04-26", "1990-06-14", "NULL"], ["1990-91", "1990-10-05", "1990-10-26", "1990-11-02", "1991-04-21", "NULL", "NULL", "1991-04-25", "1991-06-12", "NULL"], ["1991-92", "1991-10-04", "1991-10-25", "1991-11-01", "1992-04-19", "NULL", "NULL", "1992-04-23", "1992-06-14", "NULL"], ["1992-93", "1992-10-02", "1992-10-23", "1992-11-06", "1993-04-25", "NULL", "NULL", "1993-04-29", "1993-06-20", "NULL"], ["1993-94", "1993-10-01", "1993-10-22", "1993-11-05", "1994-04-24", "NULL", "NULL", "1994-04-28", "1994-06-22", "NULL"], ["1994-95", "1994-10-07", "1994-10-28", "1994-11-04", "1995-04-23", "NULL", "NULL", "1995-04-27", "1995-06-14", "NULL"], ["1995-96", "1995-10-06", "1995-10-27", "1995-11-03", "1996-04-21", "NULL", "NULL", "1996-04-25", "1996-06-16", "NULL"], ["1996-97", "1996-10-04", "1996-10-25", "1996-11-01", "1997-04-20", "NULL", "NULL", "1997-04-24", "1997-06-13", "NULL"], ["1997-98", "1997-10-03", "1997-10-24", "1997-11-01", "1998-06-14", "NULL", "NULL", "1998-06-16", "1998-06-14", "Season shortened due to lockout"], ["1998-99", "1999-01-18", "1999-02-05", "1999-02-05", "1999-05-09", "NULL", "NULL", "1999-05-11", "1999-06-25", "NULL"], ["1999-00", "1999-09-30", "1999-10-29", "1999-11-02", "2000-04-19", "NULL", "NULL", "2000-04-22", "2000-06-19", "NULL"], ["2000-01", "2000-10-06", "2000-10-27", "2000-10-31", "2001-04-18", "NULL", "NULL", "2001-04-21", "2001-06-15", "NULL"], ["2001-02", "2001-10-05", "2001-10-26", "2001-10-30", "2002-04-17", "NULL", "NULL", "2002-04-20", "2002-06-12", "NULL"], ["2002-03", "2002-10-04", "2002-10-25", "2002-10-29", "2003-04-16", "NULL", "NULL", "2003-04-19", "2003-06-15", "NULL"], ["2003-04", "2003-10-04", "2003-10-24", "2003-10-28", "2004-04-14", "NULL", "NULL", "2004-04-17", "2004-06-15", "NULL"], ["2004-05", "2004-10-04", "2004-10-22", "2004-11-02", "2005-04-20", "NULL", "NULL", "2005-04-23", "2005-06-23", "NULL"], ["2005-06", "2005-10-04", "2005-10-21", "2005-11-01", "2006-04-19", "NULL", "NULL", "2006-04-22", "2006-06-20", "NULL"], ["2006-07", "2006-10-03", "2006-10-27", "2006-10-31", "2007-04-18", "NULL", "NULL", "2007-04-21", "2007-06-14", "NULL"], ["2007-08", "2007-10-02", "2007-10-26", "2007-10-30", "2008-04-16", "NULL", "NULL", "2008-04-19", "2008-06-05", "NULL"], ["2008-09", "2008-10-07", "2008-10-26", "2008-10-28", "2009-04-15", "NULL", "NULL", "2009-04-18", "2009-06-14", "NULL"], ["2009-10", "2009-10-02", "2009-10-23", "2009-10-27", "2010-04-14", "NULL", "NULL", "2010-04-17", "2010-06-17", "NULL"], ["2010-11", "2010-09-28", "2010-10-22", "2010-10-26", "2011-04-13", "NULL", "NULL", "2011-04-16", "2011-06-12", "NULL"], ["2011-12", "2011-12-09", "2011-12-25", "2011-12-25", "2012-04-26", "NULL", "NULL", "2012-04-28", "2012-06-21", "Season shortened due to lockout"], ["2012-13", "2012-10-02", "2012-10-26", "2012-10-30", "2013-04-17", "NULL", "NULL", "2013-04-20", "2013-06-20", "NULL"], ["2013-14", "2013-10-05", "2013-10-25", "2013-10-29", "2014-04-16", "NULL", "NULL", "2014-04-19", "2014-06-15", "NULL"], ["2014-15", "2014-10-04", "2014-10-24", "2014-10-28", "2015-04-15", "NULL", "NULL", "2015-04-18", "2015-06-16", "NULL"], ["2015-16", "2015-10-02", "2015-10-23", "2015-10-27", "2016-04-13", "NULL", "NULL", "2016-04-16", "2016-06-19", "NULL"], ["2016-17", "2016-10-01", "2016-10-21", "2016-10-25", "2017-04-12", "NULL", "NULL", "2017-04-15", "2017-06-12", "NULL"], ["2017-18", "2017-09-30", "2017-10-13", "2017-10-17", "2018-04-11", "NULL", "NULL", "2018-04-14", "2018-06-08", "NULL"], ["2018-19", "2018-09-28", "2018-10-12", "2018-10-16", "2019-04-10", "2019-04-09", "2019-04-12", "2019-04-13", "2019-06-13", "NULL"], ["2019-20", "2019-10-04", "2019-10-18", "2019-10-22", "2020-03-11", "NULL", "NULL", "NULL", "NULL", "NBA Hiatus (COVID-19)"], ["2020-21", "2020-12-11", "2020-12-19", "2020-12-22", "2021-05-16", "2021-05-18", "2021-05-21", "2021-07-06", "2021-07-22", "NULL"], ["2021-22", "2021-09-28", "2021-10-15", "2021-10-19", "2022-04-10", "2022-04-12", "2022-04-15", "2022-06-26", "2022-07-08", "NULL"], ["2022-23", "2022-09-30", "2022-10-14", "2022-10-18", "2023-04-09", "2023-04-11", "2023-04-14", "2023-06-18", "2023-06-30", "NULL"]]

db_path = '/workspaces/nba_data/data/nba.sqlite'

# Define a function to convert the row values to a dictionary
def row_to_dict(row):
    return {
        "Season": row[0],
        "Start": row[3] if row[3] != "NULL" else None,
        "End": row[4] if row[4] != "NULL" else None,
        "Segment": "Regular" if row[5] == "NULL" else "Playoffs"
    }

async def main():
    
    segments = ["PRESEASON","REGULAR","PLAYIN","PLAYOFFS"]

    sql = '''
    INSERT INTO nba_seasons (season, start, end, segment, notes)
    VALUES (?, ?, ?, ?, ?)
    '''
    # Use list comprehension to create a list of dictionaries
    for season in seasons:
        season_id = season[0]
        for i in range(4):
            if season[i*2+1] == 'NULL': 
                continue

            async with aiosqlite.connect(db_path) as conn:
            
                note = None
                if i == 1:
                    note = None if season[-1] == 'NULL' else season[-1]

                data = [season_id,season[i*2+1],season[i*2+2],segments[i],note]

                # Execute SQL
                await conn.execute(sql, data)

                # Commit the changes and close the database connection
                await conn.commit()                
               
if __name__ == "__main__":
    asyncio.run(main())
